# Etapa de build
FROM node:18-slim AS builder

WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# Etapa final com Caddy
FROM caddy:2-alpine

# Copia os arquivos do build do React
COPY --from=builder /app/build /usr/share/caddy

# Copia o Caddyfile (configuração)
COPY Caddyfile /etc/caddy/Caddyfile

# Servidor roda como não-root por padrão
EXPOSE 80
